<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Order details</title>
    <link rel="stylesheet" th:href="@{/offer/css/base.css}">
    <link rel="stylesheet" th:href="@{/offer/css/order-details.css}">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
<div th:replace="base::navbar"></div>

<main class="orderDetailsContainer">
<h2>Order details</h2>


<p>
    <b>Order ID:</b> <span th:text="${order.orderId}"></span><br>
    <b>Address ID:</b> <span th:text="${order.store.address}"></span><br>

    <b>Date:</b> <span th:text="${order.orderDate}"></span><br>
    <b>Status:</b> <span th:text="${order.status}"></span><br>
    <b>Total price:</b> <span th:text="${order.price}"></span>
</p>

<h3>Products</h3>

<table border="1">
    <tr>
        <th>Product</th>
        <th>Quantity</th>
        <th>Unit price</th>
        <th>Total</th>
    </tr>

    <tr th:each="orderOffer : ${orderOffers}">
        <td th:text="${orderOffer.offer.product.name}"></td>
        <td th:text="${orderOffer.quantity}"></td>
        <td th:text="${orderOffer.offer.price}"></td>
        <td th:text="${orderOffer.quantity * orderOffer.offer.price}"></td>
        <td>
            <form th:action="@{/offer/orders/item/remove}" method="post"
                  th:if="${order.status == 'CREATED'}">

                <input type="hidden"
                       name="orderOfferId"
                       th:value="${orderOffer.orderOfferId}" />

                <button type="submit">Remove</button>
            </form>
        </td>
    </tr>
</table>

<form th:if="${order.status == 'CREATED'}"
      th:action="@{/offer/orders/finalize}"
      method="post">

    <input type="hidden"
           name="orderId"
           th:value="${order.orderId}" />

    <button type="submit">Place order</button>
</form>

<form th:if="${order.status == 'ORDERED'}"
      th:action="@{/offer/orders/cancel}"
      method="post"
      style="margin-top:10px;">

    <input type="hidden"
           name="orderId"
           th:value="${order.orderId}" />

    <button type="submit"
            style="background-color:#c0392b;color:white;">
        Cancel
    </button>
</form>
</main>
<br>
<a href="/offer/orders">Back to orders</a>

</body>
</html>
